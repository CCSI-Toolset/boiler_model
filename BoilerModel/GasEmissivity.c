/* GasEmissivity.f -- translated by f2c (version 20100827).
   You must link the resulting object file with libf2c:
	on Microsoft Windows system, link with libf2c.lib;
	on Linux or Unix systems, link with .../path/to/libf2c.a -lm
	or, if you install libf2c.a in a standard place, with -lf2c -lm
	-- in that order, at the end of the command line, as in
		cc *.o -lf2c -lm
	Source for libf2c is in /netlib/f2c/libf2c.zip, e.g.,

		http://www.netlib.org/f2c/libf2c.zip
*/

#include "f2c.h"

/* Common Block Declarations */

struct {
    doublereal w[1], xpart[1], t[1], dd[1];
    integer npt;
} cpart_;

#define cpart_1 cpart_

struct {
    doublereal ommin, ommax, twall, p[6]	/* was [6][1] */, specie[5];
} cmain_;

#define cmain_1 cmain_

struct {
    integer nom;
} cmain2_;

#define cmain2_1 cmain2_

struct cparam_1_ {
    doublereal gamma[28]	/* was [4][7] */;
};

#define cparam_1 (*(struct cparam_1_ *) &cparam_)

struct cco2_1_ {
    doublereal sd15[480]	/* was [6][80] */;
};

#define cco2_1 (*(struct cco2_1_ *) &cco2_)

struct ch2o_1_ {
    doublereal sd[2256]	/* was [6][376] */;
};

#define ch2o_1 (*(struct ch2o_1_ *) &ch2o_)

struct cch4_1_ {
    doublereal sd7[48]	/* was [3][16] */, sd3[99]	/* was [3][33] */;
};

#define cch4_1 (*(struct cch4_1_ *) &cch4_)

/* Initialized data */

struct {
    doublereal e_1[480];
    } cco2_ = { 0., 0., 0., .0105, .03, .088, 0., 0., 0., .018, .049, .088, 
	    0., 0., 0., .03, .054, .074, 0., 0., 0., .03, .056, .089, 0., 0., 
	    0., .033, .069, .099, 0., 0., .0088, .038, .072, .097, 0., 0., 
	    .011, .053, .095, .124, 0., 0., .0285, .063, .099, .14, 0., 0., 
	    .033, .068, .103, .134, 0., 0., .045, .092, .138, .176, 0., 0., 
	    .049, .097, .148, .191, 0., 0., .049, .012, .188, .247, 0., 0., 
	    .048, .126, .201, .241, 0., 0., .082, .198, .27, .265, 0., .0075, 
	    .069, .14, .225, .34, 0., .0205, .082, .145, .236, .53, 0., .0355,
	     .117, .193, .295, .55, .0157, .052, .17, .235, .305, .41, .015, 
	    .088, .27, .33, .44, .52, .051, .13, .4, .53, .56, .54, .12, .165,
	     .275, .32, .42, .56, .088, .19, .43, .54, .62, .68, .11, .35, 
	    .71, .76, .76, .69, .18, .47, .92, .97, .91, .67, .097, .265, .61,
	     .72, .78, .73, .175, .38, .72, .79, .83, .84, .37, .64, .92, .96,
	     .98, .94, .59, .84, 1.07, 1.1, 1.11, 1.06, .94, 1.03, 1.15, 1.15,
	     1.15, 1.18, 1.96, 1.77, 1.46, 1.36, 1.32, 1.39, 3.45, 2.82, 1.98,
	     1.72, 1.56, 1.48, 2.82, 2.48, 2., 1.9, 1.86, 2.05, 2.54, 2.34, 
	    1.84, 1.76, 1.74, 2.03, 14.2, 8.6, 3.7, 2.6, 1.96, 1.42, 4.5, 5.7,
	     5.8, 5.2, 3.5, 4.2, 3.6, 3.1, 3.3, 2.9, 2.05, 2., 3.1, 2.6, 2., 
	    1.96, 1.8, 2.1, 2.4, 2.5, 2.3, 2.2, 1.7, 1.94, 1.82, 2., 2.18, 
	    2.05, 1.84, 1.3, 1.04, 1.35, 1.72, 1.72, 1.65, 1.3, .55, 1.2, 
	    1.43, 1.47, 1.48, 1.25, 1.36, 1.28, 1.28, 1.35, 1.38, 1.34, .21, 
	    .78, 1.27, 1.33, 1.37, 1.32, .19, .78, 1.4, 1.46, 1.47, 1.42, .9, 
	    1.06, 1.4, 1.5, 1.55, 1.34, .072, .3, .8, 1., 1.15, 1.26, .064, 
	    .21, .56, .72, .86, 1.02, .068, .21, .53, .67, .79, 1.01, .069, 
	    .21, .54, .69, .82, .91, .033, .14, .39, .53, .69, .77, .023, 
	    .078, .27, .41, .56, .89, .03, .086, .28, .4, .52, .71, .0175, 
	    .062, .225, .335, .45, .66, .0105, .045, .18, .28, .38, .6, .0045,
	     .03, .148, .24, .345, .57, 0., .014, .124, .205, .285, .43, 0., 
	    .0115, .11, .185, .26, .375, 0., .0135, .084, .14, .205, .335, 0.,
	     .0043, .065, .12, .185, .325, 0., 0., .054, .115, .18, .315, 0., 
	    0., .044, .095, .15, .27, 0., 0., .036, .079, .125, .205, 0., 0., 
	    .025, .065, .11, .178, 0., 0., .018, .062, .103, .153, 0., 0., 
	    .032, .058, .086, .147, 0., 0., .008, .051, .087, .134, 0., 0., 
	    .006, .048, .083, .133, 0., 0., 0., .043, .078, .118, 0., 0., 0., 
	    .042, .07, .108, 0., 0., 0., .036, .064, .098, 0., 0., 0., .035, 
	    .061, .087, 0., 0., 0., .032, .058, .086, 0., 0., 0., .033, .056, 
	    .075, 0., 0., 0., .03, .053, .075, 0., 0., 0., .029, .053, .085, 
	    0., 0., 0., .024, .047, .09, 0., 0., 0., .022, .045, .086, 0., 0.,
	     0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0. };

struct {
    doublereal e_1[2256];
    } ch2o_ = { .95, .103, .042, .0114, .0045, .003, 2.08, .365, .113, .0375, 
	    .0195, .0134, 3.68, .99, .3, .104, .0577, .0365, 6.5, 2.01, .65, 
	    .214, .128, .0845, 8.25, 3.25, 1.21, .415, .26, .168, 8.7, 4.52, 
	    1.89, .765, .45, .289, 8.1, 5.4, 2.61, 1.26, .695, .46, 6.82, 6., 
	    3.37, 1.79, 1.01, .679, 4.93, 6.22, 4.07, 2.3, 1.35, .935, 3.16, 
	    5.92, 4.56, 2.81, 1.72, 1.22, 1.99, 5.28, 4.79, 3.28, 2.13, 1.49, 
	    1.13, 4.5, 4.84, 3.61, 2.49, 1.79, .585, 3.7, 4.71, 3.83, 2.84, 
	    2.08, .293, 2.89, 4.43, 3.94, 3.12, 2.37, .138, 2.05, 4., 3.96, 
	    3.3, 2.6, .062, 1.43, 3.47, 3.88, 3.41, 2.8, .0255, .95, 2.92, 
	    3.7, 3.45, 2.95, .0094, .61, 2.36, 3.43, 3.42, 3.04, .0034, .386, 
	    1.88, 3.1, 3.34, 3.09, .00105, .236, 1.45, 2.74, 3.19, 3.07, 
	    3.5e-4, .144, 1.1, 2.38, 3., 3.01, 1.26e-4, .082, .818, 2.04, 
	    2.76, 2.89, 4.3e-5, .0445, .598, 1.74, 2.48, 2.75, 1.5e-5, .0242, 
	    .427, 1.45, 2.22, 2.6, 5.1e-6, .0127, .294, 1.18, 1.95, 2.41, 
	    1.7e-6, .0063, .2, .95, 1.69, 2.21, 5.7e-7, .003, .134, .748, 
	    1.46, 2., 1.95e-7, .0014, .0902, .58, 1.24, 1.78, 6.8e-8, 6.2e-4, 
	    .059, .443, 1.03, 1.56, 3.85e-8, 2.75e-4, .045, .33, .845, 1.36, 
	    6.7e-8, 1.13e-4, .0355, .242, .695, 1.17, 1.13e-7, 5e-5, .0289, 
	    .174, .56, 1., 1.95e-7, 2.3e-5, .0245, .123, .45, .855, 3.28e-7, 
	    1.03e-5, .0214, .1, .357, .718, 5.6e-7, 4.6e-6, .0189, .083, .278,
	     .595, 9.5e-7, 2.05e-6, .0174, .073, .239, .492, 1.6e-6, 1.4e-6, 
	    .0166, .0665, .211, .405, 2.75e-6, 3.5e-6, .0165, .063, .195, 
	    .352, 4.7e-6, 8.5e-6, .0167, .062, .19, .312, 8.1e-6, 2.15e-5, 
	    .0175, .063, .191, .289, 1.36e-5, 5.7e-5, .0188, .0675, .194, 
	    .281, 2.35e-5, 1.5e-4, .0208, .0745, .202, .283, 4e-5, 3.8e-4, 
	    .0233, .0865, .223, .314, 6.8e-5, 9.5e-4, .0268, .122, .26, .38, 
	    1.2e-4, .00245, .0343, .176, .328, .461, 2e-4, .0062, .0638, .251,
	     .411, .511, 3.65e-4, .014, .107, .33, .458, .542, 6.8e-4, .033, 
	    .166, .405, .487, .571, .0013, .0635, .244, .459, .535, .557, 
	    .0025, .123, .341, .477, .502, .562, .005, .212, .407, .547, .531,
	     .514, .0103, .285, .489, .592, .497, .486, .0219, .328, .491, 
	    .558, .489, .485, .0485, .345, .505, .521, .477, .484, .114, .361,
	     .538, .563, .503, .502, .249, .46, .621, .624, .538, .538, .397, 
	    .569, .749, .768, .581, .565, .418, .627, .824, .849, .64, .594, 
	    1.08, 1.25, 1.13, .94, .807, .663, 1.65, 1.55, 1.18, .67, .562, 
	    .483, 1.42, .675, .557, .349, .276, .263, .451, .202, .132, .118, 
	    .134, .156, .0603, .0538, .0863, .112, .12, .125, .501, .252, 
	    .118, .112, .131, .14, .73, .43, .237, .191, .171, .17, 1.49, 
	    .506, .294, .238, .21, .201, 1., .553, .434, .34, .26, .22, .802, 
	    .658, .528, .411, .3, .24, .58, .527, .46, .378, .322, .283, .33, 
	    .403, .43, .356, .318, .27, .25, .393, .405, .342, .301, .275, 
	    .147, .249, .313, .318, .291, .268, .091, .252, .298, .295, .269, 
	    .253, .058, .158, .214, .244, .244, .245, .037, .113, .184, .218, 
	    .214, .218, .0244, .118, .156, .188, .195, .2, .0162, .0606, 
	    .0976, .141, .166, .179, .0112, .0425, .0903, .133, .148, .156, 
	    .0078, .04, .0765, .112, .129, .137, .0054, .0352, .0647, .0876, 
	    .11, .118, .0038, .0252, .0507, .0705, .0888, .1, .0026, .0179, 
	    .0377, .0546, .0724, .0828, .0018, .0123, .0294, .0443, .0608, 
	    .0686, .00127, .0085, .0212, .0378, .0579, .064, 8.8e-4, .0068, 
	    .0152, .0275, .0449, .0521, .0062, .004, .0107, .0214, .0374, 
	    .0453, 4.8e-4, .00298, .00931, .0189, .0329, .0403, 4.05e-4, 
	    .00175, .00696, .0152, .0295, .0365, 3.21e-4, .0012, .00452, 
	    .0101, .0252, .0331, 2.29e-4, 7.21e-4, .00364, .0093, .0225, 
	    .0305, 1.95e-4, 5.44e-4, .00318, .0075, .0202, .0284, 1.54e-4, 
	    3.75e-4, .00185, .00603, .0175, .0269, 1.01e-4, 2.63e-4, .00119, 
	    .0048, .0156, .0253, 8.52e-5, 1.85e-4, 9.09e-4, .0036, .0133, 
	    .0241, 7.63e-5, 1.37e-4, 7.11e-4, .00316, .0122, .0237, 6.15e-5, 
	    1.26e-4, 6.1e-4, .00257, .0101, .0218, 4.8e-5, 1.13e-4, 5.18e-4, 
	    .00201, .0092, .02, 3.72e-5, 1.06e-4, 4.35e-4, .00168, .00785, 
	    .0183, 3.55e-5, 1.01e-4, 3.76e-4, .00168, .00669, .0166, 3.58e-5, 
	    9.9e-5, 3.66e-4, .00167, .00651, .0156, 3.89e-5, 1.02e-4, 3.76e-4,
	     .00167, .00641, .0152, 4.22e-5, 1.06e-4, 3.73e-4, .00168, .00656,
	     .015, 5.21e-5, 1.11e-4, 3.71e-4, .0017, .00673, .0152, 6.46e-5, 
	    1.21e-4, 3.84e-4, .00179, .00798, .0179, 7.42e-5, 1.29e-4, 
	    4.79e-4, .00201, .00788, .0175, 9.53e-5, 1.65e-4, 5.44e-4, .00249,
	     .00945, .0204, 1.01e-4, 1.9e-4, 7.61e-4, .00324, .0106, .0231, 
	    1.47e-4, 2.72e-4, 8.92e-4, .00441, .0125, .0257, 1.95e-4, 3.26e-4,
	     .001, .00499, .0147, .0295, 2.61e-4, 4.21e-4, .00145, .00568, 
	    .0161, .0306, 3.05e-4, 5.15e-4, .00195, .00754, .0185, .0363, 
	    3.62e-4, 6.45e-4, .00237, .0083, .0205, .0373, 5.07e-4, 8.5e-4, 
	    .00274, .00888, .0234, .0431, 7.99e-4, .00118, .00322, .011, 
	    .0262, .0451, 9.35e-4, .0016, .00386, .0126, .0292, .053, .00108, 
	    .00231, .00451, .014, .0306, .0536, .00192, .00271, .00563, .0159,
	     .0357, .0629, .00263, .003, .00625, .0179, .0385, .0666, .00295, 
	    .0033, .00701, .0203, .046, .0782, .0031, .0037, .00846, .022, 
	    .0519, .0889, .0034, .004, .00969, .0279, .0662, .109, .0073, 
	    .0045, .0111, .0272, .0676, .109, .009, .0048, .0137, .0372, 
	    .0864, .133, .001, .0051, .0162, .0471, .1, .142, 6.4e-4, .0055, 
	    .0205, .053, .122, .168, .0016, .006, .0247, .0633, .135, .177, 
	    .0033, .007, .0283, .077, .153, .185, .0041, .0086, .0376, .0914, 
	    .166, .206, .0041, .0103, .0514, .117, .194, .228, .0029, .0129, 
	    .0664, .147, .22, .254, .0022, .0161, .0834, .171, .237, .263, 
	    .0022, .0212, .103, .201, .268, .283, .0025, .0285, .135, .24, 
	    .295, .295, .0031, .0385, .169, .272, .312, .301, .0042, .054, 
	    .214, .309, .329, .307, .006, .077, .267, .343, .332, .314, .0094,
	     .117, .333, .372, .344, .303, .0165, .173, .365, .385, .353, .3, 
	    .036, .258, .438, .393, .315, .288, .072, .375, .51, .409, .294, 
	    .271, .133, .401, .499, .39, .281, .257, .215, .5, .443, .341, 
	    .254, .23, .318, .45, .346, .286, .245, .219, .442, .4, .354, 
	    .279, .233, .216, .473, .405, .347, .281, .238, .219, .568, .501, 
	    .423, .315, .243, .218, .69, .708, .673, .432, .268, .189, .617, 
	    .831, .566, .32, .194, .123, 1.81, .52, .2, .131, .124, .107, 
	    .136, .124, .12, .119, .115, .115, .455, .298, .167, .129, .123, 
	    .112, .76, .503, .242, .154, .129, .127, .836, .584, .277, .184, 
	    .161, .145, .84, .728, .422, .236, .197, .167, .505, .5, .379, 
	    .276, .227, .192, .117, .4, .423, .315, .243, .202, .046, .3, 
	    .358, .29, .23, .202, .0183, .205, .269, .235, .195, .192, .0073, 
	    .135, .186, .179, .159, .168, .00557, .079, .113, .124, .124, 
	    .134, .00283, .0415, .0662, .0886, .103, .106, .00226, .0197, 
	    .0367, .0594, .0801, .0879, .00155, .0086, .0211, .0395, .0503, 
	    .061, .00103, .00521, .0119, .0246, .0354, .048, 8.21e-4, .00365, 
	    .00759, .0166, .0258, .037, 7.52e-4, .00183, .00445, .01, .0179, 
	    .0268, 4.29e-4, .00141, .00354, .00821, .0142, .0212, 3.27e-4, 
	    9.02e-4, .00209, .00588, .0112, .0172, 2.25e-4, 6.85e-4, .00189, 
	    .00512, .0101, .0164, 1.86e-4, 5.51e-4, .00156, .00366, .00812, 
	    .0136, 1.73e-4, 4.72e-4, .00139, .00306, .00661, .0115, 1.38e-4, 
	    3.95e-4, .0011, .00272, .00587, .0104, 9e-5, 2.7e-4, 9.68e-4, 
	    .00222, .00497, .00921, 7.52e-5, 2.33e-4, 7.44e-4, .00208, .00466,
	     .00876, 6.18e-5, 1.75e-4, 6.38e-4, .00185, .00465, .00914, 
	    5.04e-5, 1.34e-4, 4.99e-4, .00174, .00455, .00935, 3.75e-5, 
	    1.23e-4, 4.85e-4, .00182, .00456, .00971, 3.05e-5, 8.92e-5, 
	    3.38e-4, .00134, .0046, .0104, 2.57e-5, 7.9e-5, 3.29e-4, .00154, 
	    .00477, .0112, 2.42e-5, 7.4e-5, 3.08e-4, .00135, .00497, .0122, 
	    2.15e-5, 6.53e-5, 2.82e-4, .00131, .00521, .0133, 2.18e-5, 6.6e-5,
	     2.72e-4, .00152, .00573, .0148, 2.15e-5, 6.71e-5, 2.68e-4, 
	    .00134, .00607, .0159, 2.17e-5, 6.95e-5, 2.85e-4, .00161, .00677, 
	    .0173, 2.19e-5, 7.22e-5, 2.97e-4, .00169, .00783, .0197, 2.26e-5, 
	    7.71e-5, 3.41e-4, .00236, .00925, .0226, 2.5e-5, 8.15e-5, 3.87e-4,
	     .00286, .0106, .025, 2.8e-5, 8.45e-5, 4.2e-4, .00357, .0124, 
	    .0276, 3.51e-5, 1.92e-4, 4.7e-4, .00467, .0166, .0313, 4.35e-5, 
	    2e-4, .00105, .00566, .0185, .0341, 5.22e-5, 2.33e-4, .00129, 
	    .00736, .0229, .0378, 6.73e-5, 3.06e-4, .00183, .00982, .0258, 
	    .0404, 8.86e-5, 3.99e-4, .00246, .0128, .0302, .043, 1.13e-4, 
	    6.18e-4, .00346, .0161, .0358, .0459, 1.74e-4, 8.25e-4, .00441, 
	    .02, .0417, .0493, 2.65e-4, .00163, .00777, .0245, .045, .0507, 
	    3.55e-4, .002, .00978, .0317, .0492, .0527, 5.38e-4, .00271, 
	    .0167, .0401, .0503, .0523, 6.51e-4, .00301, .0264, .0467, .052, 
	    .0526, 9.87e-4, .0053, .0321, .0499, .0523, .051, .00135, .0086, 
	    .0389, .0528, .0513, .0492, .00226, .013, .0472, .0559, .05, 
	    .0469, .00431, .0198, .0526, .0557, .048, .0452, .00628, .0282, 
	    .0488, .0495, .0451, .043, .009, .039, .0471, .0449, .043, .0423, 
	    .018, .0462, .0412, .0391, .0403, .0415, .0348, .071, .0402, .036,
	     .0384, .0414, .0718, .059, .0399, .036, .0376, .042, .111, .0368,
	     .034, .0369, .0409, .0454, .0329, .0285, .0365, .0423, .0461, 
	    .0482, .0281, .027, .0432, .0505, .0529, .0511, .121, .0422, 
	    .0589, .0598, .0572, .0544, .139, .105, .0844, .0687, .0593, .056,
	     .0774, .071, .0683, .0618, .0556, .0534, .0858, .0483, .0579, 
	    .0547, .0503, .0495, .0985, .0575, .0589, .051, .0451, .0449, 
	    .0996, .0682, .0539, .0489, .0454, .0446, .068, .068, .0548, 
	    .0495, .046, .0458, .0325, .052, .0515, .0483, .0449, .0454, .015,
	     .035, .0451, .0464, .0452, .0449, .0062, .0238, .0369, .0408, 
	    .0414, .0417, .0027, .0158, .0282, .0339, .0366, .0384, .00113, 
	    .0101, .0203, .0263, .0303, .0333, 8.29e-4, .0059, .0148, .0206, 
	    .0247, .0295, 3.65e-4, .0031, .00969, .0154, .0203, .0258, 2.4e-4,
	     .0013, .00589, .0112, .0164, .0222, 1.58e-4, 4e-4, .00417, .0085,
	     .0134, .019, 1.03e-4, 2.62e-4, .00208, .00594, .0109, .0162, 
	    7.41e-5, 1.81e-4, .00142, .00455, .00907, .0141, 6.25e-5, 1.35e-4,
	     8.16e-4, .00316, .00698, .0121, 4.99e-5, 1.11e-4, 6.24e-4, .0023,
	     .00551, .0102, 3.25e-5, 6.77e-5, 4.25e-4, .00124, .00385, .00818,
	     2.31e-5, 5.63e-5, 2.78e-4, 9.86e-4, .0029, .00672, 1.65e-5, 
	    4.81e-5, 2.47e-4, 9.44e-4, .00253, .00612, 1.26e-5, 4.32e-5, 
	    2.41e-4, 8.86e-4, .0022, .00582, 1.18e-5, 4.2e-5, 2.35e-4, 
	    8.47e-4, .00209, .00571, 1.1e-5, 4.08e-5, 2.26e-4, 8.12e-4, 
	    .00221, .00604, 1.01e-5, 4e-5, 2.13e-4, 8.05e-4, .00239, .00641, 
	    9.83e-6, 3.95e-5, 1.86e-4, 8.01e-4, .00247, .00691, 9.79e-6, 
	    4.01e-5, 1.93e-4, 8.05e-4, .0026, .00732, 9.76e-6, 4.1e-5, 
	    2.01e-4, 8.14e-4, .00285, .00776, 9.88e-6, 4.2e-5, 2.1e-4, 
	    8.32e-4, .00317, .00842, 9.91e-6, 4.25e-5, 2.19e-4, 8.77e-4, 
	    .0034, .00888, 1.02e-5, 4.35e-5, 2.31e-4, 9.37e-4, .00361, .00929,
	     1.1e-5, 4.86e-5, 2.44e-4, 9.71e-4, .00402, .00994, 1.27e-5, 
	    5.79e-5, 2.57e-4, .00111, .00437, .0104, 1.31e-5, 6.12e-5, 
	    2.77e-4, .00113, .00465, .011, 1.5e-5, 7.83e-5, 3.53e-4, .00116, 
	    .0051, .0116, 1.78e-5, 9.22e-5, 3.94e-4, .00157, .00555, .0123, 
	    2.03e-5, 1.15e-4, 4.81e-4, .00188, .00601, .0131, 2.3e-5, 1.45e-4,
	     6.17e-4, .00183, .00644, .0139, 2.8e-5, 1.87e-4, 7.23e-4, .00202,
	     .00686, .0146, 3.05e-5, 2.09e-4, 8.11e-4, .00243, .00779, .0157, 
	    4.55e-5, 2.44e-4, 9.35e-4, .00243, .00844, .0166, 6.61e-5, 3.2e-4,
	     9.89e-4, .00288, .00902, .0173, 7.23e-5, 3.97e-4, .00122, .00359,
	     .01, .0184, 8.47e-5, 4.81e-4, .00143, .00429, .0108, .0192, 
	    1.03e-4, 5.91e-4, .00174, .00488, .0116, .02, 1.31e-4, 7.03e-4, 
	    .00247, .00549, .0124, .0205, 1.65e-4, 8.72e-4, .00265, .00641, 
	    .0131, .0211, 2.05e-4, .0011, .00298, .00749, .014, .0218, 
	    2.53e-4, .0013, .00346, .00811, .015, .023, 3.38e-4, .0015, 
	    .00445, .0089, .0159, .0237, 4.37e-4, .0017, .00491, .0107, .017, 
	    .0245, 5.81e-4, .0019, .00537, .0116, .0179, .0254, 6.85e-4, 
	    .0022, .00578, .0128, .0189, .0263, 9e-4, .0025, .00649, .0134, 
	    .0195, .0275, .00121, .0028, .00722, .0142, .0202, .0281, .00152, 
	    .0033, .00813, .0161, .0212, .0288, .00185, .0037, .00907, .0168, 
	    .0222, .0292, .0022, .0043, .00929, .0183, .0233, .0294, .00255, 
	    .005, .0114, .0195, .0245, .0289, .0029, .0058, .0167, .0215, 
	    .026, .0291, .0032, .0067, .0208, .0237, .0274, .0293, .0036, 
	    .0088, .022, .0253, .0282, .03, .004, .0092, .0238, .0273, .029, 
	    .0304, .0046, .0108, .0272, .0279, .0298, .031, .0053, .0128, 
	    .0304, .0292, .0297, .0312, .0062, .0152, .0344, .0303, .0293, 
	    .031, .0076, .0182, .0341, .0297, .029, .03, .0098, .0222, .0398, 
	    .0318, .0291, .0294, .0132, .0271, .0402, .0294, .0274, .0282, 
	    .019, .0335, .0421, .0286, .0262, .0269, .024, .0432, .0431, 
	    .0276, .0245, .0257, .0288, .057, .0458, .027, .0228, .0243, 
	    .0323, .074, .0449, .0261, .0214, .0221, .057, .089, .0435, .0225,
	     .0199, .0196, .0216, .068, .0378, .0239, .0195, .0192, .0126, 
	    .0475, .0364, .0238, .0197, .0192, .0117, .0369, .0385, .0249, 
	    .0212, .0204, .014, .037, .0419, .0272, .0228, .0213, .0425, 
	    .0418, .044, .028, .0248, .0229, .064, .046, .0427, .029, .0263, 
	    .0238, .0385, .0385, .0374, .0259, .0235, .0224, .0182, .0179, 
	    .0282, .0231, .0211, .0214, .017, .0081, .0191, .0175, .0181, 
	    .0194, .0161, .0037, .0105, .0127, .0152, .0171, .0145, .0017, 
	    .00554, .00855, .0113, .0131, .00175, .0014, .00385, .00595, 
	    .00803, .00945, 7.72e-4, 7.51e-4, .00384, .00575, .00537, .00594, 
	    4.91e-4, 6e-4, .00301, .00453, .0038, .00434, 2.75e-4, 4.1e-4, 
	    .00193, .00366, .00319, .00332, .0185, 2.8e-4, .00131, .00232, 
	    .00247, .00256, 1.01e-4, 1.6e-4, 9.15e-4, .0015, .00186, .00197, 
	    6.91e-5, 1.1e-4, 5.65e-4, .00114, .00205, .00192, 4.76e-5, 7.5e-5,
	     .00114, .00124, .00175, .00187, 3.05e-5, 5.9e-5, 5.29e-4, .00114,
	     .0016, .00185, 2.4e-5, 4.8e-5, 2.93e-4, 8.42e-4, .00141, .00184, 
	    1.7e-5, 3.6e-5, 1.22e-4, 4.35e-4, .00124, .00182, 1.2e-5, 2.4e-5, 
	    1.21e-4, 4.35e-4, .00118, .00187, 8.1e-6, 1.7e-5, 1.03e-4, 
	    4.39e-4, .00126, .00192, 5.5e-6, 1.2e-5, 8.66e-5, 3.67e-4, .00119,
	     .00193, 3.9e-6, 9e-6, 7.16e-5, 3.51e-4, .00116, .00194, 2.95e-6, 
	    8.3e-6, 3.73e-5, 2.54e-4, .00114, .00196, 2.3e-6, 8e-6, 4.65e-5, 
	    2.98e-4, .00117, .00201, 2.25e-6, 8.2e-6, 3.67e-5, 2.52e-4, 
	    .00116, .00205, 2.2e-6, 8.4e-6, 3.71e-5, 2.68e-4, .00127, .00211, 
	    2.23e-6, 9.2e-6, 3.96e-5, 2.73e-4, .00128, .00216, 2.35e-6, 
	    1.03e-5, 4.15e-5, 2.63e-4, .00121, .00221, 2.8e-6, 1.25e-5, 
	    6.33e-5, 3.63e-4, .00136, .00231, 3.1e-6, 1.5e-5, 9.79e-5, 
	    4.92e-4, .0015, .00241, 3.7e-6, 1.8e-5, 1.2e-4, 5.8e-4, .00167, 
	    .00251, 4.2e-6, 2e-5, 9.87e-5, 5.09e-4, .00171, .00257, 5.1e-6, 
	    2.4e-5, 1.34e-4, 5.47e-4, .00173, .00267, 6e-6, 2.7e-5, 1.21e-4, 
	    5.34e-4, .00172, .00274, 7.2e-6, 3e-5, 2.04e-4, 6.84e-4, .00184, 
	    .00285, 8.2e-6, 3.3e-5, 2.76e-4, 8.19e-4, .00199, .00297, 1e-5, 
	    3.8e-5, 3.17e-4, 8.59e-4, .00214, .00308, 1.25e-5, 4.2e-5, 2.4e-4,
	     8.18e-4, .0022, .00317, 1.45e-5, 5e-5, 4.52e-4, .00109, .00238, 
	    .00293, 1.75e-5, 5.6e-5, 3.01e-4, 9.41e-4, .00243, .00342, 
	    1.98e-5, 6.3e-5, 2.8e-4, .00107, .0026, .00353, 2.3e-5, 7.1e-5, 
	    2.76e-4, .00109, .00272, .00365, 2.8e-5, 8.3e-5, 3.69e-4, .00127, 
	    .00295, .00377, 3.3e-5, 8.9e-5, 4.3e-4, .00139, .00306, .00385, 
	    3.6e-5, 9.5e-5, 3.71e-4, .00135, .00306, .00384, 3.9e-5, 9.8e-5, 
	    4.34e-4, .00147, .00316, .00385, 4e-5, 9.9e-5, 3.97e-4, .00143, 
	    .00318, .00384, 4e-5, 9.8e-5, 3.64e-4, .00141, .00317, .00381, 
	    3.9e-5, 9.4e-5, 3.9e-4, .00142, .00314, .00376, 3.8e-5, 9e-5, 
	    3.8e-4, .00145, .00318, .00375, 3.8e-5, 9e-5, 3.8e-4, .00145, 
	    .00318, .00375, 3.3e-5, 7.5e-5, 3.58e-4, .00138, .0031, .00372, 
	    2.7e-5, 5.8e-5, 3.82e-4, .00143, .00315, .00369, 2.4e-5, 5e-5, 
	    3.43e-4, .00136, .00306, .00363, 2e-5, 4.5e-5, 3.09e-4, .00134, 
	    .00306, .00359, 1.8e-5, 4e-5, 2.81e-4, .00127, .00294, .00341, 
	    1.7e-5, 3.6e-5, 2.76e-4, .00124, .0029, .00336, 1.6e-5, 3.1e-5, 
	    2.72e-4, .00122, .00283, .00323, 1.4e-5, 2.8e-5, 2.41e-4, .00117, 
	    .00273, .00309, 1.2e-5, 2.5e-5, 2.37e-4, .00115, .00269, .00297, 
	    1e-5, 2.2e-5, 2.18e-4, .00111, .00259, .00284, 9.2e-6, 1.98e-5, 
	    2.06e-4, .00105, .00246, .00269, 8.1e-6, 1.7e-5, 2.05e-4, .001, 
	    .00235, .00257, 7.2e-6, 1.6e-5, 1.77e-4, 9.21e-4, .0022, .00245, 
	    6.5e-6, 1.5e-5, 1.72e-4, 8.34e-4, .00205, .00232, 5.9e-6, 1.3e-5, 
	    1.47e-4, 7.35e-4, .00194, .00218, 5.1e-6, 1.1e-5, 1.2e-4, 6.29e-4,
	     .00177, .00203, 4.6e-6, 9.5e-6, 9.6e-5, 5.13e-4, .00154, .0018, 
	    4.2e-6, 8e-6, 5.78e-5, 3.14e-4, .00123, .00154, 3.8e-6, 7.2e-6, 
	    5.29e-5, 2.92e-4, .00114, .00137, 3.3e-6, 6.6e-6, 4.85e-5, 
	    2.69e-4, .00102, .00122, 2.9e-6, 5.8e-6, 4.3e-5, 2.39e-4, 8.96e-4,
	     .00107, 2.7e-6, 5.2e-6, 2.59e-5, 1.93e-4, 7.48e-4, 9.44e-4, 
	    2.4e-6, 4.5e-6, 3.16e-5, 2.07e-4, .00671, 8.48e-4, 2.2e-6, 4e-6, 
	    4.44e-6, 6.02e-5, 5.16e-4, 7.5e-4, 1.9e-6, 3.6e-6, 3.24e-6, 
	    4.6e-5, 4.39e-4, 6.88e-4, 1.7e-6, 3.2e-6, 1.8e-6, 3.21e-5, 
	    3.84e-4, 6.53e-4, 1.4e-6, 2.8e-6, 1.71e-6, 3.44e-5, 3.4e-4, 
	    6.16e-4, 1.3e-6, 2.5e-6, 2.99e-6, 6e-5, 3.43e-4, 6.19e-4, 1.2e-6, 
	    2.2e-6, 2.99e-6, 6e-5, 3.43e-4, 6.19e-4, 1., 1., 1., 1., 1., 1., 
	    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 
	    1., 1., 1., 1., 1., 1., 1., 1. };

struct {
    doublereal e_1[147];
    } cch4_ = { 0., 0., 0., 0., 0., .03, 0., 0., .22, .16, .2, .47, .34, .34, 
	    .62, .69, .53, .65, 1.27, .88, 1.09, 1.68, 1.38, .87, .55, .28, 
	    .4, 1.25, .86, .93, .34, .59, .75, 0., .13, .25, 0., 0., .06, 0., 
	    0., 0., 0., 0., 0., 0., 0., 0., 0., 0., .03, 0., 0., .03, 0., 0., 
	    .03, 0., 0., .06, .03, .03, .09, .07, .07, .12, .09, .09, .12, 
	    .14, .15, .22, .18, .22, .28, .24, .31, .37, .33, .44, .47, .45, 
	    .5, .53, .59, .62, .62, .74, .7, .68, .91, .77, .72, 1., .81, .75,
	     1.03, .84, .78, 1.03, .84, .78, 1., .81, .75, .94, .77, .72, .72,
	     .68, .68, .52, .63, .63, .33, .5, .56, .25, .42, .5, .17, .26, 
	    .37, .08, .18, .31, .04, .11, .22, 0., .06, .16, 0., .02, .12, 0.,
	     0., .06, 0., 0., .03, 0., 0., 0., 0., 0., 0. };

struct {
    doublereal e_1[28];
    } cparam_ = { .09, .12, 0., .07, .07, .09, 0., .06, 0., 0., .16, 0., .06, 
	    .1, 0., .06, .055, .04, 0., .05, .07, .09, 0., .06, .01, .44, 0., 
	    0. };


/* Table of constant values */

static doublereal c_b9 = .5;
static doublereal c_b20 = 2.;
static doublereal c_b24 = 3.141593;
static real c_b32 = -1.f;
static doublereal c_b37 = -.5;
static doublereal c_b54 = 4.;
static doublereal c_b78 = 3.;
static doublereal c_b135 = 1.5;
static doublereal c_b142 = .8;
static doublereal c_b146 = -5.;

/* ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc */
/*  GasEmissivity.f, CALCULATE GAS EMISSIVITY */

/*  FUNCTIONS/SUBROUTINES exported from GasEmissivity.dll: */
/*      GasEmissivity      - subroutine */
/*     emis is the returned emissivity */
/*  Inputs: */
/*  TEMP: temperature in K */
/*  MBL: mean beam length in m */
/*  PRES:  total presure in Pa */
/*  FMOLE: mole fraction of CO2, H2O, CH4, CO, O2, N2. should sum up to 1, code needs partial pressures */
/*  FVSOOT: soot volume fraction */
/*  Output: */
/*  EMIS: flame emisivity */
/*  all variable in double precision */
/* cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc */
/* Subroutine */ int gasemissivity_(doublereal *temp, doublereal *mbl, 
	doublereal *pres, doublereal *fmole, doublereal *fvsoot, doublereal *
	emis)
{
    static integer i__;
    static doublereal ptot;
    extern /* Subroutine */ int radcal_(doublereal *);

/* DEC$ ATTRIBUTES DLLEXPORT::GasEmissivity */

    /* Parameter adjustments */
    --fmole;

    /* Function Body */
    cpart_1.npt = 1;
/* NUMBER OF ZONE */
    cpart_1.dd[0] = *mbl;
/* MEAN BEAM LENGTH IN M */
    cpart_1.t[0] = *temp;
/*  CONVERT PRESSURE FROM PA TO ATM */
/* FLAME TEMPERATURE IN K */
    ptot = *pres / 101325.f;
/*  CALCULATE SPECIES PARTIAL PRESSURE IN ATM FROM MOLE FRACTION FMOLE */
    for (i__ = 1; i__ <= 6; ++i__) {
	cmain_1.p[i__ - 1] = fmole[i__] * ptot;
    }
    cpart_1.w[0] = *fvsoot;
/* SOOT VOLUME FRACTOIN */
    cmain_1.specie[0] = cmain_1.p[0];
    cmain_1.specie[1] = cmain_1.p[1];
    cmain_1.specie[2] = cmain_1.p[2];
    cmain_1.specie[3] = cmain_1.p[3];
    cmain_1.specie[4] = cpart_1.w[0];
    cmain_1.twall = 0.f;
/* WALL TEMPERATURE, SET TO VERY SMALL NUMBER */
    cmain_1.ommin = 50.f;
/* MINIMUM WAVE NUMBER IN CM-1 */
    cmain_1.ommax = 1e4f;
/* MAXIMUM WAVE NUMBER IN CM-1 */
    cmain2_1.nom = (integer) ((1100.f - cmain_1.ommin) / 5.f) + 156 + (
	    integer) ((cmain_1.ommax - 5e3f) / 50.f);
    radcal_(emis);
    return 0;
} /* gasemissivity_ */


/* ************************************************************************** */

/* Subroutine */ int radcal_(doublereal *emis)
{
    /* System generated locals */
    integer i__1, i__2;
    doublereal d__1, d__2;

    /* Builtin functions */
    double pow_dd(doublereal *, doublereal *), log(doublereal), exp(
	    doublereal), pow_ri(real *, integer *), pow_di(doublereal *, 
	    integer *);

    /* Local variables */
    static integer i__, j, n;
    static doublereal q, u[4]	/* was [4][1] */, x[4]	/* was [4][1] */, y, 
	    ab[500], ac[1], ad[1], gc[4]	/* was [4][1] */;
    static integer ii;
    extern /* Subroutine */ int co_(doublereal *, doublereal *, doublereal *, 
	    doublereal *, doublereal *, doublereal *);
    static integer kk, mm;
    static doublereal xc;
    static integer nm;
    static doublereal yc, yd, xd, uk, wl, qw[500], xt[500], xx;
    extern /* Subroutine */ int co2_(doublereal *, doublereal *, doublereal *,
	     doublereal *, doublereal *, doublereal *), h2o_(doublereal *, 
	    doublereal *, doublereal *, doublereal *, doublereal *, 
	    doublereal *);
    static doublereal gkd, arg, aom, dom, enn;
    extern /* Subroutine */ int pod_(doublereal *);
    static doublereal tau[1], rsl, rss;
    extern /* Subroutine */ int planck_func__(doublereal *, doublereal *, 
	    doublereal *);
    static doublereal abil, gkdd, abis;
    extern /* Subroutine */ int fuel_(doublereal *, doublereal *, doublereal *
	    , doublereal *, doublereal *, doublereal *, doublereal *, 
	    doublereal *);
    static integer kmin, kmax;
    static doublereal temp, taus[1], ttau[500], ptot, xtot[1], ambda[500], 
	    abgas, omega, gdinv, xstar[1], dambda, ablong, planck, gddinv, 
	    sdweak, abshrt, argnew;


/*  [NOTE: THE TOTAL INTENSITY CALCULATED IS THAT WHICH LEAVES INTERVAL J=1. */
/*  P(I,J) IS PARTIAL PRESSURE, ATM, OF SPECIES I IN  INTERVAL J. */
/*  I=1,2,3,4,5, OR 6 IMPLIES SPECIES IS CO2, H2O, CH4, CO, O2, OR N2, RESP.] */

    dom = 5.f;
    omega = cmain_1.ommin - dom;
    nm = cmain2_1.nom - 1;

/*     LOOP 1000 COMPUTES EACH SPECTRAL CONTRIBUTION */
/*     ********************************************* */
    i__1 = cmain2_1.nom;
    for (kk = 1; kk <= i__1; ++kk) {
	omega += dom;
	if (omega <= 1100.f) {
	    goto L109;
	}
	omega += 20.f;
	if (omega <= 5e3f) {
	    goto L109;
	}
	omega += 25.f;
L109:
	ambda[kk - 1] = 1e4f / omega;
	abgas = 0.f;

/*          LOOP 200 COMPUTES THE CONTRIBUTION OF EACH SPECIES TO TAU */
/*          ********************************************************* */
	for (i__ = 1; i__ <= 4; ++i__) {
/*     IF SPECIE(I) IS SET TO 0., THAT PARTICULAR RADIATING SPECIES IS */
/*     NOT PRESENT.  THE SPECIES CONSIDERED ARE */
/*          I   SPECIES */
/*          1     CO2 */
/*          2     H2O */
/*          3     CH4 */
/*          4     CO */
/*          5     PARTICULATES */
	    if (cmain_1.specie[i__ - 1] == 0.f) {
		goto L200;
	    }

/*               LOOP 100 IS FOR EACH ELEMENT ALONG PATH */
/*               *************************************** */
	    i__2 = cpart_1.npt;
	    for (j = 1; j <= i__2; ++j) {
/*     (CALCULATION PROCEEDS IN ACCORDANCE WITH THE SLG MODEL, TABLE 5-18 */
/*     IN NASA SP-3080.) */
		if (kk > 1) {
		    goto L107;
		}
		u[i__ + (j << 2) - 5] = 273.f / cpart_1.t[j - 1] * cmain_1.p[
			i__ + j * 6 - 7] * 100.f * cpart_1.dd[j - 1];
		gc[i__ + (j << 2) - 5] = 0.f;
		ptot = 0.f;
		for (ii = 1; ii <= 6; ++ii) {
		    ptot = cmain_1.p[ii + j * 6 - 7] + ptot;
/* L105: */
		    d__1 = 273.f / cpart_1.t[j - 1];
		    gc[i__ + (j << 2) - 5] += cparam_1.gamma[i__ + (ii << 2) 
			    - 5] * cmain_1.p[ii + j * 6 - 7] * pow_dd(&d__1, &
			    c_b9);
		}
		gc[i__ + (j << 2) - 5] += cparam_1.gamma[i__ + 23] * 
			cmain_1.p[i__ + j * 6 - 7] * 273.f / cpart_1.t[j - 1];
L107:
		if (cmain_1.p[i__ + j * 6 - 7] == 0.f) {
		    goto L121;
		}
		temp = cpart_1.t[j - 1];
		switch (i__) {
		    case 1:  goto L101;
		    case 2:  goto L102;
		    case 3:  goto L103;
		    case 4:  goto L104;
		}
L101:
		co2_(&omega, &temp, &gc[(j << 2) - 4], &sdweak, &gdinv, &
			gddinv);
		goto L108;
L102:
		h2o_(&omega, &temp, &gc[(j << 2) - 3], &sdweak, &gdinv, &
			gddinv);
		goto L108;
L103:
		fuel_(&omega, &temp, &cmain_1.p[j * 6 - 4], &ptot, &gc[(j << 
			2) - 2], &sdweak, &gdinv, &gddinv);
		goto L108;
L104:
		co_(&omega, &temp, &gc[(j << 2) - 1], &sdweak, &gdinv, &
			gddinv);
L108:
		uk = sdweak * u[i__ + (j << 2) - 5];
		if (j == 1) {
		    goto L110;
		}
		gkd = uk * gdinv;
		gkdd = uk * gddinv;
		xstar[j - 1] = xstar[j - 2] + uk;
		ad[j - 1] = (xstar[j - 2] * ad[j - 2] + gkdd) / xstar[j - 1];
		ac[j - 1] = (xstar[j - 2] * ac[j - 2] + gkd) / xstar[j - 1];
		goto L115;
L110:
		xstar[0] = uk + 1e-34;
		abgas = uk / cpart_1.dd[0] + abgas;
		ad[0] = gddinv;
		ac[0] = gdinv;
L115:
		if (xstar[j - 1] < 1e-6f) {
		    goto L125;
		}
		d__2 = xstar[j - 1] / 1.7f / ad[j - 1];
		d__1 = log(pow_dd(&d__2, &c_b20) + 1.f);
		xd = ad[j - 1] * 1.7f * pow_dd(&d__1, &c_b9);
		d__1 = xd / xstar[j - 1];
		yd = 1.f - pow_dd(&d__1, &c_b20);
		d__1 = xstar[j - 1] / 4.f / ac[j - 1] + 1.f;
		xc = xstar[j - 1] / pow_dd(&d__1, &c_b9);

/*   THE FOLLOWING LOOP COMPUTES THE OPTICAL THICKNESS, XC, FOR METHANE USING */
/*   THE GODSON EQUATION AND AN APPROXIMATION TO THE LADENBERG-REICHE */
/*   FUNCTION AS RECOMMENDED BY BROSMER AND TIEN (JQSRT 33,P 521).  THE */
/*   ERROR FUNCTION IS FOUND FROM ITS SERIES EXPANSION. */

		if ((real) i__ != 3.f) {
		    goto L118;
		}
		if (xc > 10.f) {
		    goto L118;
		}
		aom = xc;
		xx = pow_dd(&c_b24, &c_b9) * .5f * xc;
		if (xx <= 3.f) {
		    goto L111;
		}
		aom = 1.f - exp(-pow_dd(&xx, &c_b20)) / (pow_dd(&c_b24, &c_b9)
			 * xx);
		goto L117;
L111:
		enn = 1.f;
		for (n = 1; n <= 30; ++n) {
		    enn *= n;
		    mm = (n << 1) + 1;
		    d__1 = xc * .88622693f;
		    arg = pow_ri(&c_b32, &n) * 1.128379f * pow_di(&d__1, &mm) 
			    / (mm * enn);
		    argnew = arg + aom;
/*     IF(ABS(ARG/ARGNEW).LT..000001)N=30 */
/* L116: */
		    aom = argnew;
		}
L117:
		if (aom >= 1.f) {
		    aom = .9999999f;
		}
		xc = -log(1.f - aom);


L118:
		d__1 = xc / xstar[j - 1];
		yc = 1.f - pow_dd(&d__1, &c_b20);
		y = 1.f / pow_dd(&yc, &c_b20) + 1.f / pow_dd(&yd, &c_b20) - 
			1.f;
/* Modified by Jinliang Ma, avoid math error */
		if (y < 1.f) {
		    y = 1.f;
		}
		d__1 = 1.f - pow_dd(&y, &c_b37);
		x[i__ + (j << 2) - 5] = xstar[j - 1] * pow_dd(&d__1, &c_b9);
		goto L100;
L121:
		if (j > 1) {
		    goto L123;
		}
		xstar[0] = 1e-34;
		ac[0] = 1.f;
		ad[0] = 1.f;
		goto L125;
L123:
		xstar[j - 1] = xstar[j - 2];
		ac[j - 1] = ac[j - 2];
		ad[j - 1] = ad[j - 2];
L125:
		x[i__ + (j << 2) - 5] = xstar[j - 1];
L100:
		;
	    }


L200:
	    ;
	}

/*  DETERMINE OPTICAL DEPTH OF SOOT */

	if (cmain_1.specie[4] == 0.f) {
	    goto L250;
	}
	pod_(&omega);
	goto L260;
L250:
	i__2 = cpart_1.npt;
	for (j = 1; j <= i__2; ++j) {
/* L255: */
	    cpart_1.xpart[j - 1] = 0.f;
	}
L260:
	ab[kk - 1] = abgas + cpart_1.xpart[0] / cpart_1.dd[0];

/*     EVALUATE THE COMBINED SPECTRAL TRANSMITTANCE AND RADIANCE */
/*     ********************************************************* */
	i__2 = cpart_1.npt;
	for (j = 1; j <= i__2; ++j) {
	    xtot[j - 1] = 0.f;
	    for (i__ = 1; i__ <= 4; ++i__) {
		if (cmain_1.specie[i__ - 1] == 0.f) {
		    x[i__ + (j << 2) - 5] = 0.f;
		}
		xtot[j - 1] = x[i__ + (j << 2) - 5] + xtot[j - 1];
/* L300: */
	    }
	    xtot[j - 1] += cpart_1.xpart[j - 1];
	    if (xtot[j - 1] >= 99.f) {
		goto L305;
	    }
	    tau[j - 1] = exp(-xtot[j - 1]);
	    goto L310;
L305:
	    tau[j - 1] = 0.f;
L310:
	    if (j == 1) {
		goto L510;
	    }
	    planck_func__(&cpart_1.t[j - 1], &ambda[kk - 1], &planck);
	    qw[kk - 1] -= (tau[j - 1] - tau[j - 2]) * planck;
	    goto L500;
L510:
	    planck_func__(cpart_1.t, &ambda[kk - 1], &planck);
	    qw[kk - 1] = -(tau[0] - 1.f) * planck;
L500:
	    ;
	}
	xt[kk - 1] = xtot[cpart_1.npt - 1];
	ttau[kk - 1] = tau[cpart_1.npt - 1];
	planck_func__(&cmain_1.twall, &ambda[kk - 1], &planck);
	qw[kk - 1] += ttau[kk - 1] * planck;
/* L1000: */
    }

/*  INTEGRATE THE RADIANCE OVER THE SPECTRUM */

    q = qw[0] * (ambda[0] - ambda[1]);
    i__1 = nm;
    for (kk = 2; kk <= i__1; ++kk) {
/* L1100: */
	q += qw[kk - 1] * (ambda[kk - 2] - ambda[kk]) / 2.f;
    }
    q += qw[cmain2_1.nom - 1] * (ambda[cmain2_1.nom - 2] - ambda[cmain2_1.nom 
	    - 1]);

/*  DETERMINE SOOT RADIANCE FOR SHORT AND LONG WAVELENGTHS. */

    rsl = 0.f;
    rss = 0.f;
    ablong = 0.f;
    abshrt = 0.f;
    abil = 0.f;
    abis = 0.f;
    if (cmain_1.specie[4] == 0.f && cmain_1.twall == 0.f) {
	goto L1090;
    }
    kmax = (integer) (cmain_1.ommin / 5 * 5);
    i__1 = kmax;
    for (kk = 5; kk <= i__1; kk += 5) {
	omega = (real) kk;
	wl = 1e4f / omega;
	dambda = 1e4f / (omega - 2.5f) - 1e4f / (omega + 2.5f);
	pod_(&omega);
	i__2 = cpart_1.npt;
	for (j = 1; j <= i__2; ++j) {
	    if (cpart_1.xpart[j - 1] >= 33.f) {
		goto L1010;
	    }
	    taus[j - 1] = exp(-cpart_1.xpart[j - 1]);
	    goto L1012;
L1010:
	    taus[j - 1] = 0.f;
L1012:
	    if (j == 1) {
		goto L1021;
	    }
	    planck_func__(&cpart_1.t[j - 1], &wl, &planck);
	    rsl -= (taus[j - 1] - taus[j - 2]) * planck * dambda;
	    goto L1020;
L1021:
	    planck_func__(cpart_1.t, &wl, &planck);
	    rsl -= (taus[0] - 1.f) * planck * dambda;
	    planck_func__(cpart_1.t, &wl, &planck);
	    ablong += cpart_1.xpart[0] / cpart_1.dd[0] * planck * dambda * 
		    5.5411e7f / pow_dd(cpart_1.t, &c_b54);
	    planck_func__(&cmain_1.twall, &wl, &planck);
	    d__1 = cmain_1.twall + 1e-6f;
	    abil += cpart_1.xpart[0] / cpart_1.dd[0] * planck * dambda * 
		    5.5411e7f / pow_dd(&d__1, &c_b54);
L1020:
	    ;
	}
	planck_func__(&cmain_1.twall, &wl, &planck);
	rsl += taus[cpart_1.npt - 1] * planck * dambda;
/* L1040: */
    }
    kmin = (integer) (cmain_1.ommax / 100 * 100);
    for (kk = kmin; kk <= 25000; kk += 100) {
	omega = (real) kk;
	wl = 1e4f / omega;
	dambda = 1e4f / (omega - 50.f) - 1e4f / (omega + 50.f);
	pod_(&omega);
	i__1 = cpart_1.npt;
	for (j = 1; j <= i__1; ++j) {
	    if (cpart_1.xpart[j - 1] >= 33.f) {
		goto L1050;
	    }
	    taus[j - 1] = exp(-cpart_1.xpart[j - 1]);
	    goto L1060;
L1050:
	    taus[j - 1] = 0.f;
L1060:
	    if (j == 1) {
		goto L1071;
	    }
	    planck_func__(&cpart_1.t[j - 1], &wl, &planck);
	    rss -= (taus[j - 1] - taus[j - 2]) * planck * dambda;
	    goto L1070;
L1071:
	    planck_func__(cpart_1.t, &wl, &planck);
	    rss -= (taus[0] - 1.f) * planck * dambda;
	    planck_func__(cpart_1.t, &wl, &planck);
	    abshrt += cpart_1.xpart[0] / cpart_1.dd[0] * planck * dambda * 
		    5.5411e7f / pow_dd(cpart_1.t, &c_b54);
	    planck_func__(&cmain_1.twall, &wl, &planck);
	    d__1 = cmain_1.twall + 1e-6f;
	    abis += cpart_1.xpart[0] / cpart_1.dd[0] * planck * dambda * 
		    5.5411e7f / pow_dd(&d__1, &c_b54);
L1070:
	    ;
	}
	planck_func__(&cmain_1.twall, &wl, &planck);
	rss += taus[cpart_1.npt - 1] * planck * dambda;
/* L1080: */
    }
L1090:
    q = q + rss + rsl;
/* Finally Calculate emissivity (pi*Q/sigma/T^4) */
    *emis = q * 5.5407e7f / pow_dd(cpart_1.t, &c_b54);
    if (*emis > .9999f) {
	*emis = .9999f;
    }
    return 0;
} /* radcal_ */


/* ***************************************************************************** */

/* Subroutine */ int co2_(doublereal *omega, doublereal *temp, doublereal *
	gc1, doublereal *sdweak, doublereal *gdinv, doublereal *gddinv)
{
    /* System generated locals */
    doublereal d__1, d__2;

    /* Builtin functions */
    double pow_dd(doublereal *, doublereal *), exp(doublereal);

    /* Local variables */
    static doublereal a, b, d__, g;
    static integer i__, j, k, l;
    static doublereal v, c2, f1, f2, t0, t1, w1, v3, aa, bb, cc, be, dd, ee, 
	    gd, ff, gg, x13, x23, x33, to, wm, tt, tw, ww, om1, om2, om3, gam,
	     oma, om12, omb, com1, com2, com3, bcnt[3], xbar, dinv, atot[3], 
	    test, vbar1, dinv1, dinv2, dinv3, temp1, temp2, temp3, omvv3, 
	    alpha, delta, ttemp, splus, unflo1, unflo2, unflo3, omvbar, 
	    omprim, sdstrg, sminus;

    if (*omega > 5725.f) {
	goto L300;
    }
    wm = 44.f;
    d__1 = *temp / (wm * 273.f);
    gd = *omega * 5.94e-6f * pow_dd(&d__1, &c_b9);
    if (*omega > 4550.f) {
	goto L500;
    }
    if (*omega > 3800.f) {
	goto L300;
    }
    if (*omega > 3050.f) {
	goto L100;
    }
    if (*omega > 2474.f) {
	goto L300;
    }
    if (*omega > 1975.f) {
	goto L100;
    }
    if (*omega > 1100.f) {
	goto L300;
    }
    if (*omega > 880.f) {
	goto L600;
    }
    if (*omega > 500.f) {
	goto L400;
    }
    goto L300;
/* ONTRIBUTION TO 2.0 MICRON BAND FROM (000)-(041),(000)-(121),AND (000) */
/*     -(201) TRANS. */
L500:
    om1 = 1354.91f;
    om2 = 673.f;
    om3 = 2396.49f;
    bcnt[0] = 4860.5f;
    bcnt[1] = 4983.5f;
    bcnt[2] = 5109.f;
    to = 300.f;
    c2 = 1.4388f;
    be = .391635f;
    com1 = om2 * 4.f + om3;
    com2 = om1 + om2 * 2.f + om3;
    com3 = om1 * 2.f + om3;
    d__1 = 1.f - exp(-c2 * com3 / *temp / (1.f - exp(-c2 * om1 / *temp)));
    atot[2] = to * .426f / *temp * pow_dd(&d__1, &c_b20) / (1.f - exp(-c2 * 
	    om3 / *temp));
    d__1 = 1.f - exp(-c2 * om2 / *temp);
    atot[1] = to * 1.01f / *temp * (1.f - exp(-c2 * com2 / *temp)) / (1.f - 
	    exp(-c2 * om1 / *temp)) / pow_dd(&d__1, &c_b20) / (1.f - exp(-c2 *
	     om3 / *temp));
    d__1 = 1.f - exp(-c2 * om2 / *temp);
    atot[0] = to * .272f / *temp * (1.f - exp(-c2 * com1 / *temp)) / pow_dd(&
	    d__1, &c_b54) / (1.f - exp(-c2 * om3 / *temp));
    *sdweak = 0.f;
    for (k = 1; k <= 3; ++k) {
	d__2 = *omega - bcnt[k - 1];
	*sdweak += atot[k - 1] * c2 / (be * 4.f * *temp) * (d__1 = *omega - 
		bcnt[k - 1], abs(d__1)) * exp(-c2 / (be * 4.f * *temp) * 
		pow_dd(&d__2, &c_b20));
/* L510: */
    }
    dinv = 1.f / (be * 4.f);
    *gdinv = *gc1 * dinv;
    *gddinv = gd * dinv;
/* ***EXPRESS S/D AT STP, AS IS IN NASA SP-3080 */
    *sdweak = *sdweak * *temp / 273.f;
    return 0;
L100:
    b = .391635f;
    a = .0030875f;
    x13 = -19.37f;
    x23 = -12.53f;
    x33 = -12.63f;
    om1 = 1354.91f;
    om2 = 673.f;
    om3 = 2396.49f;
    t0 = 300.f;
    c2 = 1.4388f;
    xbar = (x13 * .5f + x23) * .5f;
    om12 = (om1 * .5f + om2) * .5f;
    *sdweak = 0.f;
    sdstrg = 0.f;
    if (*omega <= 2395.f) {
	goto L200;
    }
/* ALCULATE ABSORPTION COEF. AND LINE SPACING PARAMETER FOR 2.7 MICRON BAND */
    l = 1;
/* ONTRIBUTION TO 2.7 MICRON BAND FROM (000)-(021) AND (010)-(031) TRANS. */
    alpha = 28.5f;
    omprim = om2 * 2.f + om3;
L120:
    d__1 = 1.f - exp(-om12 * c2 / t0);
    aa = alpha * b * c2 / (a * (1.f - exp(-om3 * c2 / t0)) * pow_dd(&d__1, &
	    c_b78) * (exp(-om12 * c2 / t0) + 1.f) * (1.f - exp(-omprim * c2 / 
	    t0)));
    d__1 = 1.f - exp(-om12 * c2 / *temp);
    bb = (1.f - exp(-c2 * *omega / *temp)) * (1.f - exp(-c2 * om3 / *temp)) * 
	    pow_dd(&d__1, &c_b78) * (exp(-om12 * c2 / *temp) + 1.f) * (1.f - 
	    exp(-c2 * omprim / *temp));
    cc = aa * bb * *omega / *temp * t0 / *temp;
    for (j = 1; j <= 20; ++j) {
	v = (real) (j - 1);
	if (j / 2 << 1 == j) {
	    g = (v + 1.f) * (v + 3.f) / 4.f;
	}
	if (j / 2 << 1 != j) {
	    g = (v + 2.f) * (v + 2.f) / 4.f;
	}
	vbar1 = (v + 3.f) * (v + 4.f) / (v + 2.f) / 6.f - 1.f;
	if (j / 2 << 1 == j) {
	    vbar1 = (v + 5.f) / 6.f - 1.f;
	}
	for (k = 1; k <= 10; ++k) {
	    v3 = (real) (k - 1);
	    dd = (v3 + 1) * g * exp(-(v3 * om3 + v * om12) * c2 / *temp) * (
		    vbar1 + 1.f);
	    gam = b - a * (v3 + 1.f);
	    if (l == 2) {
		goto L125;
	    }
	    omvv3 = 3598.f - v * 18.f - v3 * 47.f;
	    if (v == 0.f) {
		omvv3 = 3613.f - v3 * 47.f;
	    }
	    goto L130;
L125:
	    omvv3 = 3728.f - v * 5.f - v3 * 47.f;
	    if (v == 0.f) {
		omvv3 = 3715.f - v3 * 47.f;
	    }
L130:
	    delta = a * (*omega - omvv3);
	    if (gam * gam <= delta) {
		goto L102;
	    }
	    d__1 = gam * gam - delta;
	    d__ = pow_dd(&d__1, &c_b9) * 2.f;
	    omvbar = omvv3 * (1.f - exp(-omvv3 * c2 / *temp));
	    f1 = gam - d__ / 2;
	    f2 = gam + d__ / 2.f;
	    ee = c2 * gam / (a * a * *temp);
	    unflo1 = ee * delta * (a * .5f / gam + 1.f);
	    if (unflo1 <= -78.f) {
		goto L102;
	    }
	    unflo2 = ee * 2.f * gam * f1;
	    if (unflo2 >= 78.f) {
		goto L102;
	    }
	    ff = exp(ee * delta * (a * .5f / gam + 1.f));
	    sminus = cc * dd / omvbar * abs(f1) * ff * exp(-ee * 2.f * gam * 
		    f1);
	    unflo3 = ee * 2.f * gam * f2;
	    if (unflo3 >= 78.f) {
		goto L160;
	    }
	    splus = cc * dd / omvbar * abs(f2) * ff * exp(-ee * 2.f * gam * 
		    f2);
	    goto L170;
L160:
	    splus = 0.f;
L170:
	    gg = *sdweak;
	    *sdweak = (sminus + splus) / d__ + *sdweak;
	    test = (*sdweak - gg) / *sdweak;
	    if (test < 1e-4f) {
		goto L102;
	    }
	    d__1 = g * .5f;
	    sdstrg = pow_dd(&d__1, &c_b9) * (pow_dd(&sminus, &c_b9) + pow_dd(&
		    splus, &c_b9)) / d__ + sdstrg;
/* L101: */
	}
L102:
	;
    }
    if (l == 2) {
	goto L250;
    }
/* ONTRIBUTION TO 2.7 MICRON BAND FROM (000)-(101) AND (010)-(111) TRANS. */
    alpha = 42.3f;
    omprim = om1 + om3;
    l = 2;
    goto L120;
/* ALCULATE ABSORPTION COEF AND LINE SPACING PARAMETER FOR 4.3 MICRON BAND */
L200:
    alpha = 2700.f;
    omprim = om3;
    d__1 = 1.f - exp(-om12 * c2 / t0);
    aa = alpha * b * c2 / (a * (1.f - exp(-om3 * c2 / t0)) * pow_dd(&d__1, &
	    c_b78) * (exp(-om12 * c2 / t0) + 1.f) * (1.f - exp(-omprim * c2 / 
	    t0)));
    d__1 = 1.f - exp(-om12 * c2 / *temp);
    bb = (1.f - exp(-c2 * *omega / *temp)) * (1.f - exp(-c2 * om3 / *temp)) * 
	    pow_dd(&d__1, &c_b78) * (exp(-om12 * c2 / *temp) + 1.f) * (1.f - 
	    exp(-c2 * omprim / *temp));
    cc = aa * bb * *omega / *temp * t0 / *temp;
    for (j = 1; j <= 20; ++j) {
	v = (real) (j - 1);
	if (j / 2 << 1 == j) {
	    g = (v + 1.f) * (v + 3.f) / 4.f;
	}
	if (j / 2 << 1 != j) {
	    g = (v + 2.f) * (v + 2.f) / 4.f;
	}
	for (k = 1; k <= 10; ++k) {
	    v3 = (real) (k - 1);
	    dd = (v3 + 1.f) * g * exp(-(v3 * om3 + v * om12) * c2 / *temp);
	    gam = b - a * (v3 + 1.f);
	    omvv3 = om3 + x13 * .5f + x23 + x33 * 2.f + xbar * v + x33 * 2.f *
		     v3;
	    delta = a * (*omega - omvv3);
	    if (gam * gam <= delta) {
		goto L202;
	    }
	    d__1 = gam * gam - delta;
	    d__ = pow_dd(&d__1, &c_b9) * 2.f;
	    omvbar = omvv3 * (1.f - exp(-omvv3 * c2 / *temp));
	    f1 = gam - d__ / 2;
	    f2 = gam + d__ / 2.f;
	    ee = c2 * gam / (a * a * *temp);
	    unflo1 = ee * delta * (a * .5f / gam + 1.f);
	    if (unflo1 <= -78.f) {
		goto L202;
	    }
	    unflo2 = ee * 2.f * gam * f1;
	    if (unflo2 >= 78.f) {
		goto L202;
	    }
	    ff = exp(ee * delta * (a * .5f / gam + 1.f));
	    sminus = cc * dd / omvbar * abs(f1) * ff * exp(-ee * 2.f * gam * 
		    f1);
	    unflo3 = ee * 2.f * gam * f2;
	    if (unflo3 >= 78.f) {
		goto L246;
	    }
	    splus = cc * dd / omvbar * abs(f2) * ff * exp(-ee * 2.f * gam * 
		    f2);
	    goto L247;
L246:
	    splus = 0.f;
L247:
	    gg = *sdweak;
	    *sdweak = (sminus + splus) / d__ + *sdweak;
	    test = (*sdweak - gg) / *sdweak;
	    if (test < 1e-4f) {
		goto L202;
	    }
	    d__1 = g * .5f;
	    sdstrg = pow_dd(&d__1, &c_b9) * (pow_dd(&sminus, &c_b9) + pow_dd(&
		    splus, &c_b9)) / d__ + sdstrg;
/* L201: */
	}
L202:
	;
    }
L250:
    if (*sdweak == 0.f) {
	goto L300;
    }
    dinv = sdstrg * sdstrg / *sdweak;
    *gdinv = *gc1 * dinv;
    *gddinv = gd * dinv;
/* ***EXPRESS S/D AT STP, AS IS K IN NASA SP-3080 */
    *sdweak = *sdweak * *temp / 273.f;
    return 0;
/* ONTRIBUTION TO 10.0 MICRON BAND FROM (100)-(001) AND (020)-(001) TRANS. */
L600:
    om1 = 1354.91f;
    om2 = 673.f;
    om3 = 2396.49f;
    c2 = 1.4388f;
    bcnt[0] = 960.8f;
    bcnt[1] = 1063.6f;
    oma = om3;
    omb = (om1 + om2 * 2.f) / 2.f;
    to = 300.f;
    atot[0] = .0219f;
    atot[1] = .0532f;
    be = .391635f;
    for (k = 1; k <= 2; ++k) {
	atot[k - 1] = to / *temp * atot[k - 1] * exp(c2 * omb * (1.f / to - 
		1.f / *temp)) * (1.f - exp(-c2 * (oma - omb) / *temp)) / (1.f 
		- exp(-c2 * oma / *temp)) / (1.f - exp(-omb * c2 / *temp));
/* L610: */
    }
    *sdweak = 0.f;
    for (i__ = 1; i__ <= 2; ++i__) {
	d__2 = *omega - bcnt[i__ - 1];
	*sdweak += atot[i__ - 1] * c2 / (be * 4.f * *temp) * (d__1 = *omega - 
		bcnt[i__ - 1], abs(d__1)) * exp(-c2 / (be * 4.f * *temp) * 
		pow_dd(&d__2, &c_b20));
/* L620: */
    }
    dinv = .25f / be;
    *gdinv = *gc1 * dinv;
    *gddinv = gd * dinv;
/* ***EXPRESS S/D AT STP, AS IS IN NASA SP-3080 */
    *sdweak = *sdweak * *temp / 273.f;
    return 0;
/* ONTRIBUTION TO 15.0 MICRON BAND FROM (000)-(010) TRANS. */
L400:
    ttemp = *temp;
    j = (integer) ((*omega - 495.f) / 5.f);
    w1 = (real) j * 5.f + 495.f;
    ww = (*omega - w1) / 5;
    if (*temp > 2400.f) {
	*temp = 2399.99f;
    }
    if (*temp < 300.f) {
	*temp = 300.f;
    }
    i__ = (integer) (*temp / 300.f);
    if (i__ > 2 && *temp < 1200.f) {
	goto L410;
    }
    if (i__ > 5 && *temp < 2400.f) {
	goto L420;
    }
    t1 = (real) i__ * 300.f;
    tt = (*temp - t1) / 300.f;
    if (i__ > 4) {
	--i__;
    }
    goto L430;
L410:
    i__ = 2;
    tt = (*temp - 600.f) / 600.f;
    goto L430;
L420:
    i__ = 5;
    tt = (*temp - 1800.f) / 600.f;
L430:
    tw = tt * ww;
    *sdweak = cco2_1.sd15[i__ + j * 6 - 7] * (1.f - tt - ww + tw) + 
	    cco2_1.sd15[i__ + 1 + j * 6 - 7] * (tt - tw) + cco2_1.sd15[i__ + (
	    j + 1) * 6 - 7] * (ww - tw) + cco2_1.sd15[i__ + 1 + (j + 1) * 6 - 
	    7] * tw;
    if (*sdweak == 0.f) {
	goto L300;
    }
/* ALCULATE LINE SPACING PARAMETER FOR 15.0 MICRON BAND */
    dinv1 = 1.2f;
    dinv2 = 8.f;
    dinv3 = 30.f;
    temp1 = 300.f;
    temp2 = 550.f;
    temp3 = 830.f;
    dinv = dinv1 * (*temp - temp2) * (*temp - temp3) / (temp1 - temp2) / (
	    temp1 - temp3) + dinv2 * (*temp - temp1) * (*temp - temp3) / (
	    temp2 - temp1) / (temp2 - temp3) + dinv3 * (*temp - temp1) * (*
	    temp - temp2) / (temp3 - temp1) / (temp3 - temp2);
    *gdinv = *gc1 * dinv;
    *gddinv = gd * dinv;
    return 0;
L300:
    *sdweak = 0.f;
    *gdinv = 1.f;
    *gddinv = 1.f;
    return 0;
} /* co2_ */


/* **************************************************************************** */

/* Subroutine */ int h2o_(doublereal *omega, doublereal *temp, doublereal *
	gc2, doublereal *sdweak, doublereal *gdinv, doublereal *gddinv)
{
    /* System generated locals */
    doublereal d__1;

    /* Builtin functions */
    double pow_dd(doublereal *, doublereal *), sin(doublereal), exp(
	    doublereal);

    /* Local variables */
    static doublereal b, d__;
    static integer i__, j;
    static doublereal t1, w1, gd, wm, tt, tw, ww, dinv, ttemp;

    if (*omega >= 9300.f || *omega < 50.f) {
	goto L200;
    }
    wm = 18.f;
    d__1 = *temp / (wm * 273.f);
    gd = *omega * 5.94e-6f * pow_dd(&d__1, &c_b9);
    j = (integer) ((*omega - 25.f) / 25.f);
    ttemp = *temp;
    if (*temp >= 2500.f) {
	*temp = 2499.99f;
    }
    if (*temp < 300.f) {
	*temp = 300.f;
    }
    i__ = (integer) (*temp / 500.f + 1);
    if (i__ == 2 && *temp < 600.f) {
	i__ = 1;
    }
    w1 = (real) j * 25.f + 25.f;
    ww = (*omega - w1) / 25.f;
    if (i__ > 2) {
	goto L75;
    }
    if (i__ == 1) {
	tt = (*temp - 300.f) / 300.f;
    }
    if (i__ == 2) {
	tt = (*temp - 600.f) / 400.f;
    }
    goto L100;
L75:
    t1 = (real) (i__ - 1) * 500.f;
    tt = (*temp - t1) / 500.f;
L100:
    tw = tt * ww;
    *sdweak = ch2o_1.sd[i__ + j * 6 - 7] * (1.f - tt - ww + tw) + ch2o_1.sd[
	    i__ + 1 + j * 6 - 7] * (tt - tw) + ch2o_1.sd[i__ + (j + 1) * 6 - 
	    7] * (ww - tw) + ch2o_1.sd[i__ + 1 + (j + 1) * 6 - 7] * tw;
    d__ = *temp * .003004f - 2.294f - pow_dd(temp, &c_b20) * 3.66e-7f;
    b = sin(*omega * .0036f - 8.043f);
    dinv = exp(b * .7941f + d__);
/*     DINV=EXP(0.00106*TEMP-1.21) */
    *gdinv = *gc2 * dinv;
    *gddinv = gd * dinv;
    *temp = ttemp;
    return 0;
L200:
    *sdweak = 0.f;
    *gdinv = 1.f;
    *gddinv = 1.f;
    return 0;
} /* h2o_ */


/* *********************************************************************** */

/* Subroutine */ int co_(doublereal *omega, doublereal *temp, doublereal *gc4,
	 doublereal *sdweak, doublereal *gdinv, doublereal *gddinv)
{
    /* System generated locals */
    doublereal d__1;

    /* Builtin functions */
    double pow_dd(doublereal *, doublereal *), exp(doublereal);

    /* Local variables */
    static doublereal a, b, d__;
    static integer j;
    static doublereal v, c2, f1, f2, t0, aa, bb, cc, dd, ee, gd, ff, gg, wm, 
	    wx, wy, gam, ome, omv, dinv, test, alpha, delta, splus, omvbar, 
	    omprim, sdstrg, sminus;

    if (*omega < 1600. || *omega > 2400.f) {
	goto L300;
    }
    b = 1.93139f;
    alpha = 260.f;
    a = .017485f;
    ome = 2170.21f;
    wx = 13.461f;
    wy = .0308f;
    omprim = ome - wx * 2.f + wy * 3.25f;
    t0 = 300.f;
    c2 = 1.4388f;
    wm = 28.f;
    d__1 = *temp / (wm * 273.f);
    gd = *omega * 5.94e-6f * pow_dd(&d__1, &c_b9);
    *sdweak = 1e-99;
    sdstrg = 1e-99;
    d__1 = 1.f - exp(-omprim * c2 / t0);
    aa = alpha * b * c2 / (a * pow_dd(&d__1, &c_b20));
    d__1 = 1.f - exp(-omprim * c2 / *temp);
    bb = (1.f - exp(-(*omega) * c2 / *temp)) * pow_dd(&d__1, &c_b20);
    cc = aa * bb * *omega / *temp * t0 / *temp;
    for (j = 1; j <= 20; ++j) {
	v = (real) (j - 1);
	dd = (v + 1.f) * exp(-v * ome * c2 / *temp);
	gam = b - a * (v + 1.f);
	omv = ome - (v + 1.f) * 2.f * wx + ((v + 1.f) * 3.f * (v + 1.f) + 
		.25f) * wy;
	delta = a * (*omega - omv);
	if (gam * gam <= delta) {
	    goto L102;
	}
	d__1 = gam * gam - delta;
	d__ = pow_dd(&d__1, &c_b9) * 2.f;
	omvbar = omv * (1.f - exp(-omv * c2 / *temp));
	f1 = gam - d__ / 2.f;
	f2 = gam + d__ / 2.f;
	ee = c2 * gam / (a * a * *temp);
	ff = exp(ee * delta * (a * .5f / gam + 1.f));
	sminus = cc * dd / omvbar * abs(f1) * ff * exp(-ee * 2.f * gam * f1);
	splus = cc * dd / omvbar * abs(f2) * ff * exp(-ee * 2.f * gam * f2);
	gg = *sdweak;
	*sdweak = (sminus + splus) / d__ + *sdweak;
	test = (*sdweak - gg) / *sdweak;
	if (test < 1e-4f) {
	    goto L102;
	}
	sdstrg = (pow_dd(&sminus, &c_b9) + pow_dd(&splus, &c_b9)) / d__ + 
		sdstrg;
/* L101: */
    }
L102:
    dinv = sdstrg * sdstrg / *sdweak;
    *gdinv = *gc4 * dinv;
    *gddinv = gd * dinv;
/* ***EXPRESS S/D AT STP, AS IS K IN NASA SP-3080 */
    *sdweak = *sdweak * *temp / 273.f;
    return 0;
L300:
    *sdweak = 0.f;
    *gdinv = 1.f;
    *gddinv = 1.f;
    return 0;
} /* co_ */


/* **************************************************************************** */

/* Subroutine */ int pod_(doublereal *omega)
{
    /* System generated locals */
    integer i__1;

    /* Local variables */
    static integer j;
    static doublereal ff, rik, rin, abco, ambda;

/* ***POD CALCULATES PARTICLE OPTICAL DEPTH, XPART, OF THE VOLUME */
/*   FRACTION OF SOOT PARTICLES IN GAS CLOUD.  RIN AND RIK ARE */
/*   THE REAL AND IMAGINARY PARTS OF THE INDEX OF REFRACTION.  THE */
/*   PARTICLES ARE ASSUMED TO BE IN THE RAYLEIGH LIMIT. */

    ambda = 1e4f / *omega;
    rin = 1.6f;
    rik = .5f;
/*     FF=36.*3.1416*RIN*RIK/AMBDA/((RIN*RIN-RIK*RIK+2.)**2.+(2.*RIN*RIK) */
/*     2**2) */

/*     ABSORPTION COEF. IS BASED UPON MEASUREMENTS OF DALZELL AND */
/*     SAROFIM. */
    ff = 7.f / ambda;
    i__1 = cpart_1.npt;
    for (j = 1; j <= i__1; ++j) {
	abco = ff * cpart_1.w[j - 1] * 1e6f;
	if (j == 1) {
	    goto L290;
	}
	cpart_1.xpart[j - 1] = cpart_1.xpart[j - 2] + abco * cpart_1.dd[j - 1]
		;
	goto L300;
L290:
	cpart_1.xpart[0] = abco * cpart_1.dd[0];
L300:
	;
    }
    return 0;
} /* pod_ */


/* **************************************************************************** */

/* Subroutine */ int fuel_(doublereal *omega, doublereal *temp, doublereal *
	pch4, doublereal *ptot, doublereal *gc3, doublereal *sdweak, 
	doublereal *gdinv, doublereal *gddinv)
{
    /* System generated locals */
    doublereal d__1, d__2, d__3;

    /* Builtin functions */
    double pow_dd(doublereal *, doublereal *), exp(doublereal);

    /* Local variables */
    static integer i__, j;
    static doublereal c2, w1, be, gd, pe, pi, wm, om1, om2, om3, om4, sda, 
	    sdb, sdc, com1, com2, com3, com4, bcnt[4], dinv, atot[4];

/* J. Ma increased dimension from SD3(3,32) to SD3(3,33) otherwise out of boundary */
/*      COMMON/CCH4/SD7(3,16),SD3(3,32) */
    if (*omega > 5e3f || *omega < 1125.f) {
	goto L100;
    }
    pi = 3.14159f;
    be = 5.2412f;
    c2 = 1.4388f;
    wm = 16.f;
    d__1 = *temp / (wm * 273.f);
    gd = *omega * 5.94e-6f * pow_dd(&d__1, &c_b9);
    if (*omega > 3400.f) {
	goto L50;
    }
    pe = *ptot + *pch4 * .3f;
    if (*omega >= 2625.f) {
	goto L200;
    }
    if (*omega > 1450.f) {
	goto L100;
    }
    goto L300;

/*   CONTRIBUTION TO 2.4 MICRON BAND FROM (0000)-(0110), (0000)-(0011), */
/*   (0000)-(1001), AND (0000)-(0102) TRANS.  THE INTEGRATED BAND INTENSITIES */
/*   OF VINCENT-GEISSE (ANNALES DE PHYSIQUE SER.12, V. 10, 1955) HAVE */
/*   BEEN MULTIPLIED BY A FACTOR OF 4 AND THE LINE SPACING IS THAT */
/*   OF V4 FROM GRAY AND PENNER (JQSRT V. 5, 1965). */

L50:
    om1 = 2914.2f;
    om2 = 1526.f;
    om3 = 3020.3f;
    om4 = 1306.2f;
    bcnt[0] = 4123.f;
    bcnt[1] = 4216.3f;
    bcnt[2] = 4313.2f;
    bcnt[3] = 4546.f;
    com1 = om2 + om4 * 2.f;
    com2 = om1 + om4;
    com3 = om3 + om4;
    com4 = om2 + om3;
    d__1 = 1.f - exp(-c2 * com1 / *temp);
    d__2 = 1.f - exp(-c2 * om4 / *temp);
    atot[0] = 174.72f / pow_dd(temp, &d__1) / (1.f - exp(-c2 * om2 / *temp)) /
	     pow_dd(&d__2, &c_b20);
    atot[1] = 4804.8000000000002f / *temp * (1.f - exp(-c2 * com2 / *temp)) / 
	    (1.f - exp(-c2 * om1 / *temp)) / (1.f - exp(-c2 * om4 / *temp));
    atot[2] = 4040.4000000000001f / *temp * (1.f - exp(-c2 * com3 / *temp)) / 
	    (1.f - exp(-c2 * om3 / *temp)) / (1.f - exp(-c2 * om4 / *temp));
    atot[3] = 1375.9200000000001f / *temp * (1.f - exp(-c2 * com4 / *temp)) / 
	    (1.f - exp(-c2 * om2 / *temp)) / (1.f - exp(-c2 * om3 / *temp));
    dinv = .17421602787456444f;
    *gdinv = *gc3 * dinv;
    *gddinv = gd * dinv;
    *sdweak = 0.f;
    for (i__ = 1; i__ <= 4; ++i__) {
	d__1 = *omega - bcnt[i__ - 1];
	d__2 = c2 * be / *temp;
	d__3 = *omega - bcnt[i__ - 1];
	*sdweak += pow_dd(&d__1, &c_b20) * 2.f * pow_dd(&d__2, &c_b135) * 
		atot[i__ - 1] / pow_dd(&pi, &c_b9) * pow_dd(&dinv, &c_b78) * 
		exp(-c2 * be * pow_dd(&dinv, &c_b20) / *temp * pow_dd(&d__3, &
		c_b20));
/* L51: */
    }
    *sdweak *= *temp / 273.f;
    return 0;

/* ONTRIBUTION TO 3.3 MICRON BAND FROM (0000)-(0010) TRANS. */
/*   REFER TO BROSMER AND TIEN, JQSRT V. 33, P. 521 */
L200:
    d__1 = 273.f / *temp;
    *gdinv = pe * .00734f * pow_dd(&d__1, &c_b9) * exp((*temp - 273.f) * 
	    1.02f / 273.f);
    *gddinv = gd / 9.4f;
    j = (integer) ((*omega - 2600.f) / 25.f);
    w1 = (real) j * 25.f + 2600.f;
    sdb = cch4_1.sd3[j * 3 - 2] + (*omega - w1) / 25.f * (cch4_1.sd3[(j + 1) *
	     3 - 2] - cch4_1.sd3[j * 3 - 2]);
    if (*temp > 600.f) {
	goto L260;
    }
    sda = cch4_1.sd3[j * 3 - 3] + (*omega - w1) / 25.f * (cch4_1.sd3[(j + 1) *
	     3 - 3] - cch4_1.sd3[j * 3 - 3]);
    *sdweak = sda + (*temp - 290.f) / 310.f * (sdb - sda);
    if (*sdweak < 0.f) {
	*sdweak = 0.f;
    }
    return 0;
L260:
    sdc = cch4_1.sd3[j * 3 - 1] + (*omega - w1) / 25.f * (cch4_1.sd3[(j + 1) *
	     3 - 1] - cch4_1.sd3[j * 3 - 1]);
    *sdweak = sdb + (*temp - 600.f) / 250.f * (sdc - sdb);
    if (*sdweak < 0.f) {
	*sdweak = 0.f;
    }
    return 0;

/* ONTRIBUTION TO 7.7 MICRON BAND FROM (0000)-(0001) TRANS. */
/*    REFER TO BROSMER AND TIEN, JQSRT V. 33, P. 521. */
L300:
    d__1 = *temp / 273.f;
    *gdinv = pe * .0243f * pow_dd(&d__1, &c_b142);
    *gddinv = gd / 5.1f;
    j = (integer) ((*omega - 1100.f) / 25.f);
    w1 = (real) j * 25.f + 1100.f;
    sdb = cch4_1.sd7[j * 3 - 2] + (*omega - w1) / 25.f * (cch4_1.sd7[(j + 1) *
	     3 - 2] - cch4_1.sd7[j * 3 - 2]);
    if (*temp > 600.f) {
	goto L360;
    }
    sda = cch4_1.sd7[j * 3 - 3] + (*omega - w1) / 25.f * (cch4_1.sd7[(j + 1) *
	     3 - 3] - cch4_1.sd7[j * 3 - 3]);
    *sdweak = sda + (*temp - 290.f) / 310.f * (sdb - sda);
    if (*sdweak < 0.f) {
	*sdweak = 0.f;
    }
    return 0;
L360:
    sdc = cch4_1.sd7[j * 3 - 1] + (*omega - w1) / 25.f * (cch4_1.sd7[(j + 1) *
	     3 - 1] - cch4_1.sd7[j * 3 - 1]);
    *sdweak = sdb + (*temp - 600.f) / 250.f * (sdc - sdb);
    if (*sdweak < 0.f) {
	*sdweak = 0.f;
    }
    return 0;
L100:
    *sdweak = 0.f;
    *gdinv = 1.f;
    *gddinv = 1.f;
    return 0;
} /* fuel_ */


/* ******************************************************************************* */

/* Subroutine */ int planck_func__(doublereal *a, doublereal *b, doublereal *
	planck)
{
    /* Builtin functions */
    double exp(doublereal), pow_dd(doublereal *, doublereal *);

    /* Local variables */
    static doublereal c1, c2, ovrflo;

/*     COMPUTES BLACKBODY FUNCTION IN UNITS OF W/M-2/MICRON/SR */
    c1 = 5.9544e7f;
    c2 = 14388.f;
    if (*a == 0.f) {
	goto L100;
    }
    ovrflo = c2 / *a / *b;
    if (ovrflo > 38.f) {
	goto L100;
    }
    *planck = c1 * 2.f * pow_dd(b, &c_b146) / (exp(c2 / *a / *b) - 1.f);
    goto L101;
L100:
    *planck = 0.f;
L101:
    return 0;
} /* planck_func__ */

/* J. Ma, combined block data BD1 with BD2 to avoid gfortran problem */
/* Subroutine */ int bd1_(void)
{
    return 0;
} /* bd1_ */

/*  TEMP,K= 300     600      1000      1500      2000      2500 */
/*  TEMP,K= 300     600      1000      1500      2000      2500 */

/* Subroutine */ int bd3_(void)
{
    return 0;
} /* bd3_ */

/* J. Ma increased dimension from SD3(3,32) to SD3(3,33) otherwise out of boundary */
/*      COMMON/CCH4/SD7(3,16),SD3(3,32) */
/* J. Ma increased C6 dimension */
/*      DIMENSION C1(3,8),C2(3,8),C3(3,8),C4(3,8),C5(3,8),C6(3,8) */
/*   LINE BROADENING PARAMETERS,GAMMA(I,J), */
/*   J=CO2,H2O,CH4,CO,O2,N2,SELF RESONANT. */
/*   I=      CO2  H2O  CH4   CO */
/*    J */
/*  THE FOLLOWING ARE DATA FOR THE 15.0 MICRON BAND OF CO2 */
/*  TEMP, K=300      600      1200      1500      1800      2400 */
/*   THE FOLLOWING DATA ARE FOR THE 7.7 MICRON BAND OF CH4 */
/* TEMP,K= 290   600   850 */
/*  THE FOLLOWING DATA ARE FOR THE 3.3 MICRON BAND OF CH4 */
/* TEMP, K= 290   600   850 */
/* J. Ma, added one line */

